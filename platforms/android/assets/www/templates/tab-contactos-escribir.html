<ion-view view-title="{{nombre}}">

    <ion-content class="padding">

        <ion-refresher
            pulling-text=""
            on-refresh="cargar()">
        </ion-refresher>


        <div class="item item-balanced item-icon-right" ng-repeat="msn in mensajesEms"> 
            <div ng-if="!msn.archivo">
               <h2>{{msn.mensaje}}</h2>
               <p>{{msn.fecha}}</p> 
            </div>
            <div ng-if="msn.archivo">
               <img class="imgchat" style="width: 100%;" ng-src="{{URLBase}}{{msn.archivo}}">
               <p>{{msn.fecha}}</p> 
            </div>
        </div> 

        <div class="item item-calm item-icon-right" ng-repeat="msn in mensajesRes"> 
            <div ng-if="!msn.archivo">
                <h2>{{msn.mensaje}}</h2>
                <p>{{msn.fecha}}</p>
                <a class="button-icon icon ion-email" href="#tab/contactos/token/{{msn.token}}"></a>
            </div> 
            <div ng-if="msn.archivo">
               <img class="imgchat" style="width: 100%;" ng-src="{{URLBase}}{{msn.archivo}}">
               <p>{{msn.fecha}}</p> 
            </div>
        </div> 
        
            
        <form role="form" name="formMensaje" id="formMensaje" enctype="multipart/form-data">
            <div class="item item-input-inset formMensaje">
                <label class="item-input-wrapper">
                    <input type="text" ng-model="verifi.mensaje" required placeholder=" Escribe un mensaje">
                </label>
                <input type="file" name="file" id="agregarArchivo" uploader-model="verifi.archivo" onchange="angular.element(this).scope().enviarArchivo(event);" >
                <button class="button button-small button-dark icon ion-images" ng-disabled="formMensaje.$valid" ng-click="btnAbirArchivo();"></button>
                <button class="button button-small button-positive icon ion-android-send" ng-click="btnEnviarMensaje();" ng-disabled="formMensaje.$invalid"></button>
            </div>
        </form>
    
    </ion-content>

</ion-view>
